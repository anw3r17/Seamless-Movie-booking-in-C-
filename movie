#include <stdio.h>
#include <stdlib.h>
#include <string.h>
// Creating a double linked node 
struct node {
    int seatnumber;
    char name[100];
    struct node* prev;
    struct node* next;
};

// Now, let's implement a basic function to book seats
struct node *head = NULL;
// intialize the head to point to NULL
void addseat(int seatnumber) {
    struct node *newnode = (struct node*)malloc(sizeof(struct node));
    if (newnode == NULL) {
        printf("Memory allocation failed.\n");
        exit(1);
    }
    newnode -> seatnumber = seatnumber;
    newnode -> name[0] = '\0';
    newnode -> prev = NULL;
    newnode -> next = head;

    if (head != NULL) {
        head -> prev = newnode;
    }

    head = newnode;
}

// Now, let's implement a function which will allow us to reserve/book a seat    
void bookseat(int seatnumber, const char *name) {
    struct node *p = head;
    while (p != NULL) {
        if (p -> seatnumber == seatnumber) {
            if (p -> name[0] != '\0') {
                printf("Seat %d is already booked by %s.\n", seatnumber, p -> name);
            } else {
                strncpy(p->name, name, sizeof(p -> name) - 1);
                p -> name[sizeof(p->name) - 1] = '\0';
                printf("Seat %d booked successfully by %s.\n", seatnumber, name);
            }
            return;
        }
        p = p -> next;
    }

    printf("Seat %d not found in the Theatre.\n", seatnumber);
}

// Now, let's implement a function which will allow us to cancel/unbook a seat reservation.
void unbookseat(int seatnumber) {
    struct node *p = head;
    while (p != NULL) {
        if (p -> seatnumber == seatnumber) {
            if (p -> name[0] != '\0') {
                p -> name[0] = '\0';
                printf("Seat %d unbooked successfully.\n", seatnumber);
            } else {
                printf("Seat %d is not booked.\n", seatnumber);
            }
            return;
        }
        p = p -> next;
    }

    printf("Seat %d not found in the theatre.\n", seatnumber);
}
